# reboot-truenas.yml
- name: Boot TN
  become: true
  become_method: sudo
  delegate_to: "{{ your_proxmox_host }}"
  shell: |
    sudo /usr/sbin/qm start {{ TrueNAS_ID }}
  when: inventory_hostname  == {{ your_proxmox_host }}

- name: Execute mount -a command with sudo on all hosts in the group
  become: true
  become_method: sudo
  ansible.builtin.shell: sudo mount -a
  loop: "{{ groups['SMB'] }}"